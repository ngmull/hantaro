#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.5,units="in",res=300)
f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2)
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2)
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,
labels=c("(A)","(B)"),
label.x=c(0.21,0.18),
label.y=0.97,
font.label=list(face="plain",size=12))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,
labels=c("(A)","(B)"),
label.x=c(0.10,0.10),
label.y=0.97,
font.label=list(face="plain",size=12))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## combine
f3C=p1+p2
f3C=ggarrange(p1,p2,
labels=c("(B) infection","(C) competence"),
label.x=c(0.10,0.10),
label.y=0.97,
font.label=list(face="plain",size=12)))
f3C=ggarrange(p1,p2,
labels=c("(B) infection","(C) competence"),
label.x=c(0.10,0.10),
label.y=0.97,
font.label=list(face="plain",size=12))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2)
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.15,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2)
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.15,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1,1.2))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.15,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1,1.1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.15,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## combine
f3C=p1+p2
f3C=ggarrange(p1,p2,
labels=c("(B) infection","(C) competence"),
label.x=c(0.15,0.15),
label.y=0.97,
font.label=list(face="plain",size=12))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3C=ggarrange(p1,p2,
labels=c("(B) infection","(C) competence"),
label.x=c(0.2,0.175),
label.y=0.97,
font.label=list(face="plain",size=12))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## combine
f3C=p1+p2
f3C=ggarrange(p1,p2,
labels=c("(B) infection","(C) competence"),
label.x=c(0.05,0.05),
label.y=0.97,
font.label=list(face="plain",size=12))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3C=ggarrange(p1,p2,
labels=c("(B) infection","(C) competence"),
label.x=c(0.01,0.01),
label.y=0.97,
font.label=list(face="plain",size=12))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## figure 3a
library(viridis)
f3A=ggplot(apreds,aes(cpred))+
geom_density(aes(fill=cat,colour=cat),alpha=0.5)+
facet_wrap(~type2,ncol=1,strip.position='top',scales="free_y")+
theme_bw()+
theme(legend.position="top")+
labs(x=expression(paste("predicted probability (",italic(P),") of hosting")))+
xlim(0,1)+
theme(axis.text=element_text(size=10),
axis.title=element_text(size=12),
legend.title=element_text(size=12),
legend.text=element_text(size=11),
strip.text=element_text(size=11))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(axis.title.x=element_text(margin=margin(t=10,r=0,b=0,l=0)))+
theme(axis.title.y=element_text(margin=margin(t=0,r=10,b=0,l=0)))+
scale_colour_manual(values=c(col,viridis(2,option="E",end=0.8)))+
scale_fill_manual(values=c(col,viridis(2,option="E",end=0.8)))+
guides(colour=guide_legend(title="(A) orthohantavirus positivity"),
fill=guide_legend(title="(A) orthohantavirus positivity"))
## scatterplot
f3B=ggplot(apreds2,aes(pred_pcr,pred_comp))+
geom_point(alpha=0.5,size=2,aes(colour=cat,fill=cat))+
geom_smooth(method='gam',colour=col)+
labs(x=expression(paste(italic(P),' from infection models')),
y=expression(paste(italic(P),' from competence models')))+
theme_bw()+
theme(axis.text=element_text(size=10),
axis.title=element_text(size=12),
legend.title=element_text(size=12),
legend.text=element_text(size=11),
strip.text=element_text(size=11))+
theme(legend.position="top")+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(axis.title.x=element_text(margin=margin(t=10,r=0,b=0,l=0)))+
theme(axis.title.y=element_text(margin=margin(t=0,r=10,b=0,l=0)))+
scale_colour_manual(values=c(col,viridis(2,option="E",end=0.8)))+
scale_fill_manual(values=c(col,viridis(2,option="E",end=0.8)))+
guides(colour=guide_legend(title="(A) orthohantavirus positivity"),
fill=guide_legend(title="(A) orthohantavirus positivity"))
## combine
setwd("~/Desktop/hantaro/figs")
png("Figure 3.png",width=6.5,height=4,units="in",res=300)
f3=ggarrange(f3A,f3B,common.legend=T)
f3
dev.off()
## combine
f3C=p1+p2
f3C=ggarrange(p1,p2,
labels=c("(B) infection","(C) competence"),
label.x=c(0.01,0.01),
label.y=0.97,
font.label=list(face="plain",size=12))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## combine
f3C=p1+p2
f3C=ggarrange(p1,p2,
labels=c("(B) infection","(C) competence"),
label.x=c(0.01,0.01),
label.y=0.97,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(0.01,0.01),
label.y=0.97,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
?ggarrange
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(0.01,0.01),
label.y=0.07,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## combine
f3C=p1+p2
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(0.01,0.01),
label.y=0.1,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(-0.05,0.01),
label.y=0.1,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(-0.025,0.01),
label.y=0.1,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(-0.03,0.01),
label.y=0.1,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(-0.03,-0.03),
label.y=0.1,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(-0.03,-0.05),
label.y=0.1,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(-0.03,-0.07),
label.y=0.1,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(-0.03,-0.1),
label.y=0.1,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3A=ggplot(apreds,aes(cpred))+
geom_density(aes(fill=cat,colour=cat),alpha=0.5)+
facet_wrap(~type2,ncol=1,strip.position='top',scales="free_y")+
theme_bw()+
theme(legend.position="top")+
labs(x=expression(paste("predicted probability (",italic(P),") of hosting")))+
xlim(0,1)+
theme(axis.text=element_text(size=10),
axis.title=element_text(size=12),
legend.title=element_text(size=12),
legend.text=element_text(size=11),
strip.text=element_text(size=11),
legend.margin=margin(0,0,0,0),
legend.box.margin=margin(10,10,10,10))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(axis.title.x=element_text(margin=margin(t=10,r=0,b=0,l=0)))+
theme(axis.title.y=element_text(margin=margin(t=0,r=10,b=0,l=0)))+
scale_colour_manual(values=c(col,viridis(2,option="E",end=0.8)))+
scale_fill_manual(values=c(col,viridis(2,option="E",end=0.8)))+
guides(colour=guide_legend(title="(A) orthohantavirus positivity"),
fill=guide_legend(title="(A) orthohantavirus positivity"))
## scatterplot
f3B=ggplot(apreds2,aes(pred_pcr,pred_comp))+
geom_point(alpha=0.5,size=2,aes(colour=cat,fill=cat))+
geom_smooth(method='gam',colour=col)+
labs(x=expression(paste(italic(P),' from infection models')),
y=expression(paste(italic(P),' from competence models')))+
theme_bw()+
theme(axis.text=element_text(size=10),
axis.title=element_text(size=12),
legend.title=element_text(size=12),
legend.text=element_text(size=11),
strip.text=element_text(size=11),
legend.margin=margin(0,0,0,0),
legend.box.margin=margin(10,10,10,10))+
theme(legend.position="top")+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(axis.title.x=element_text(margin=margin(t=10,r=0,b=0,l=0)))+
theme(axis.title.y=element_text(margin=margin(t=0,r=10,b=0,l=0)))+
scale_colour_manual(values=c(col,viridis(2,option="E",end=0.8)))+
scale_fill_manual(values=c(col,viridis(2,option="E",end=0.8)))+
guides(colour=guide_legend(title="(A) orthohantavirus positivity"),
fill=guide_legend(title="(A) orthohantavirus positivity"))
## combine
setwd("~/Desktop/hantaro/figs")
png("Figure 3.png",width=6.5,height=4,units="in",res=300)
f3=ggarrange(f3A,f3B,common.legend=T)
f3
dev.off()
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
f3A=ggplot(apreds,aes(cpred))+
geom_density(aes(fill=cat,colour=cat),alpha=0.5)+
facet_wrap(~type2,ncol=1,strip.position='top',scales="free_y")+
theme_bw()+
theme(legend.position="top")+
labs(x=expression(paste("predicted probability (",italic(P),") of hosting")))+
xlim(0,1)+
theme(axis.text=element_text(size=10),
axis.title=element_text(size=12),
legend.title=element_text(size=12),
legend.text=element_text(size=11),
strip.text=element_text(size=11),
legend.margin=margin(0,0,0,0),
legend.box.margin=margin(20,20,20,20))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(axis.title.x=element_text(margin=margin(t=10,r=0,b=0,l=0)))+
theme(axis.title.y=element_text(margin=margin(t=0,r=10,b=0,l=0)))+
scale_colour_manual(values=c(col,viridis(2,option="E",end=0.8)))+
scale_fill_manual(values=c(col,viridis(2,option="E",end=0.8)))+
guides(colour=guide_legend(title="(A) orthohantavirus positivity"),
fill=guide_legend(title="(A) orthohantavirus positivity"))
## scatterplot
f3B=ggplot(apreds2,aes(pred_pcr,pred_comp))+
geom_point(alpha=0.5,size=2,aes(colour=cat,fill=cat))+
geom_smooth(method='gam',colour=col)+
labs(x=expression(paste(italic(P),' from infection models')),
y=expression(paste(italic(P),' from competence models')))+
theme_bw()+
theme(axis.text=element_text(size=10),
axis.title=element_text(size=12),
legend.title=element_text(size=12),
legend.text=element_text(size=11),
strip.text=element_text(size=11),
legend.margin=margin(0,0,0,0),
legend.box.margin=margin(20,20,20,20))+
theme(legend.position="top")+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(axis.title.x=element_text(margin=margin(t=10,r=0,b=0,l=0)))+
theme(axis.title.y=element_text(margin=margin(t=0,r=10,b=0,l=0)))+
scale_colour_manual(values=c(col,viridis(2,option="E",end=0.8)))+
scale_fill_manual(values=c(col,viridis(2,option="E",end=0.8)))+
guides(colour=guide_legend(title="(A) orthohantavirus positivity"),
fill=guide_legend(title="(A) orthohantavirus positivity"))
## combine
setwd("~/Desktop/hantaro/figs")
png("Figure 3.png",width=6.5,height=4,units="in",res=300)
f3=ggarrange(f3A,f3B,common.legend=T)
f3
dev.off()
## combine
f3C=p1+p2
f3C=ggarrange(p1,p2,
labels=c("(B) infection predictions","(C) competence predictions"),
label.x=c(-0.03,-0.1),
label.y=0.1,
font.label=list(face="plain",size=13))
## revise fig 3
setwd("~/Desktop/hantaro/figs")
png("Figure 3-2.png",width=7,height=7.25,units="in",res=300)
#f3+f3C+plot_layout(nrow=2,heights=c(1.25,1))
ggarrange(f3,f3C,nrow=2,heights=c(1.1,1))
#f3B+f3C+plot_layout(nrow=2,heights=c(1,1.5))
#f3B|(p1/p2)+plot_layout(widths=c(1.5,1))
dev.off()
## write
setwd("~/Desktop/hantaro/figs")
write.csv(predpfs,"Table S3")
## write
setwd("~/Desktop/hantaro/figs")
write.csv(predpfs,"Table S3.csv")
## round
predpfs$clade=round(predpfs$clade,2)
predpfs$other=round(predpfs$other,2)
## write
setwd("~/Desktop/hantaro/figs")
write.csv(predpfs,"Table S3.csv")
